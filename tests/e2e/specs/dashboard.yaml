# E2E Test Specification: Dashboard Page Functionality
name: "Dashboard Page Functionality Tests"
description: "Comprehensive tests for dashboard page loading, welcome card, stats cards, navigation, and user interactions"
tags: ["dashboard", "auth", "ui", "navigation", "responsive", "accessibility"]
requires_auth: true

# Test configuration
config:
  timeout: 30000  # 30 seconds for UI tests
  retries: 2

# Test scenarios - each corresponds to a test function in test_dashboard.py
scenarios:
  - name: "Dashboard Page Loads Correctly"
    description: "Verify that the dashboard page loads with all expected elements"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard to be current page"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"
        timeout: 10000

      - name: "Verify dashboard container is visible"
        action: "assert_visible"
        selector: "[x-show*='dashboard']"
        description: "Dashboard view should be displayed"

      - name: "Verify main grid layout"
        action: "assert_visible"
        selector: ".grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3"
        description: "Responsive grid layout should be present"

  - name: "Welcome Card Displays Correctly"
    description: "Test that the welcome card displays with personalized greeting"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify welcome card exists"
        action: "assert_visible"
        selector: ".card.bg-gradient-to-r.from-primary.to-secondary.col-span-full"
        description: "Welcome card should be visible and span full width"

      - name: "Verify welcome title contains greeting"
        action: "assert_text"
        selector: ".card.bg-gradient-to-r.from-primary.to-secondary .card-title"
        value: "Welcome back"
        description: "Welcome card title should contain personalized greeting"

      - name: "Verify hand-heart icon"
        action: "assert_visible"
        selector: ".card.bg-gradient-to-r.from-primary.to-secondary i[data-lucide='hand-heart']"
        description: "Hand heart icon should be present in welcome card"

      - name: "Verify welcome message"
        action: "assert_text"
        selector: ".card.bg-gradient-to-r.from-primary.to-secondary p"
        value: "development admin dashboard"
        description: "Welcome message should be displayed"

  - name: "Stats Cards Render Correctly"
    description: "Test that stats cards render with proper structure and content"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Wait for stats to load"
        action: "wait_for_timeout"
        timeout: 1000

      - name: "Verify stats cards exist"
        action: "assert_visible"
        selector: ".card.bg-base-100.shadow-xl:not(.bg-gradient-to-r)"
        description: "At least one stats card should be present"

      - name: "Verify first stats card structure"
        action: "assert_visible"
        selector: ".card.bg-base-100.shadow-xl:not(.bg-gradient-to-r) .card-body"
        description: "Stats card should have proper body structure"

  - name: "Stats Card Icons and Colors"
    description: "Test that stats cards display appropriate icons and colors"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Wait for content"
        action: "wait_for_timeout"
        timeout: 1000

      - name: "Verify stats card icon"
        action: "assert_visible"
        selector: ".card.bg-base-100.shadow-xl:not(.bg-gradient-to-r) i[data-lucide]"
        description: "Stats cards should display appropriate icons"

  - name: "Dashboard Navigation Menu"
    description: "Test dashboard navigation menu functionality"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify navigation header"
        action: "assert_visible"
        selector: "nav.navbar"
        description: "Navigation header should be present"

      - name: "Verify Dev Admin title"
        action: "assert_visible"
        selector: "nav h1:contains('Dev Admin')"
        description: "Dev Admin title should be visible"

      - name: "Verify code icon in navigation"
        action: "assert_visible"
        selector: "nav i[data-lucide='code']"
        description: "Code icon should be present in navigation"

  - name: "Theme Toggle Functionality"
    description: "Test theme toggle button functionality"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify theme toggle button"
        action: "assert_visible"
        selector: "button[title='Toggle theme']"
        description: "Theme toggle button should be visible"

      - name: "Verify theme toggle icons"
        action: "assert_visible"
        selector: "button[title='Toggle theme'] i[data-lucide='moon'], button[title='Toggle theme'] i[data-lucide='sun']"
        description: "Theme toggle should show moon or sun icon"

  - name: "User Menu Functionality"
    description: "Test user menu dropdown functionality"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify user menu button"
        action: "assert_visible"
        selector: "button[aria-label='User menu']"
        description: "User menu button should be accessible"

      - name: "Verify user avatar placeholder"
        action: "assert_visible"
        selector: "button[aria-label='User menu'] .avatar .placeholder"
        description: "User avatar placeholder should be visible"

      - name: "Click user menu"
        action: "click"
        selector: "button[aria-label='User menu']"
        timeout: 2000

      - name: "Wait for dropdown"
        action: "wait_for_timeout"
        timeout: 500

      - name: "Verify menu items appear"
        action: "assert_visible"
        selector: "ul.dropdown-content li"
        description: "User menu dropdown should show menu items"

  - name: "Dashboard Responsive Layout"
    description: "Test dashboard responsive grid layout"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify responsive grid"
        action: "assert_visible"
        selector: ".grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3"
        description: "Grid should have responsive column classes"

      - name: "Verify welcome card spans full width"
        action: "assert_visible"
        selector: ".grid .col-span-full"
        description: "Welcome card should span full grid width"

      - name: "Verify grid gap spacing"
        action: "assert_visible"
        selector: ".grid.gap-6"
        description: "Grid should have proper gap spacing"

  - name: "Dashboard Accessibility Features"
    description: "Test dashboard accessibility features"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Wait for dashboard"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"

      - name: "Verify navigation role"
        action: "assert_visible"
        selector: "nav[role='navigation']"
        description: "Navigation should have proper ARIA role"

      - name: "Verify main content container"
        action: "assert_visible"
        selector: "main.container"
        description: "Main content should be properly structured"

      - name: "Verify screen reader text"
        action: "assert_visible"
        selector: ".sr-only"
        description: "Screen reader text should be present for accessibility"

  - name: "Dashboard Loading States"
    description: "Test dashboard loading states and transitions"
    steps:
      - name: "Navigate to dashboard"
        action: "goto"
        url: "/dev/admin"
        wait_for: "networkidle"

      - name: "Verify initial view loads"
        action: "assert_visible"
        selector: "[x-show*='currentView']"
        description: "Initial view should load (auth or loading)"

      - name: "Wait for dashboard transition"
        action: "wait_for_function"
        function: "() => $store.app.currentPage === 'dashboard'"
        timeout: 10000

      - name: "Verify dashboard is active"
        action: "assert_visible"
        selector: "[x-show*='dashboard']"
        description: "Dashboard view should be active"

      - name: "Verify page transition effects"
        action: "assert_visible"
        selector: ".page-transition"
        description: "Page transition effects should be applied"